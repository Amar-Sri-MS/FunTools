# WuTrace

This directory contains scripts for converting WU log messages (generated by the --wulog option for the funos_posix
environment) into either HTML or text logs describing the WUs performed.

# Operation

Basic operation:

  funos_posix --wulog > foo.trace

  wu_trace.py foo.trace > foo.html

wu_trace.py also takes the following options:
* --format xxxx changes the output style to HTML, text, or graphviz.
* --debug prints out status messages during parsing.
* --output sets the output file (not connected yet.)

The --format flag changes the style of output.  'text' displays each
individual sequence of events in a textual tree format.  'html' outputs
the timeline-based view of each separate transaction.  'graphviz' draws
the call graph of all events seen in a single graph.

Note that the wu_log mechanism relies on the arguments passed to the
wu - frame pointer in arg0 and flow pointer in arg1 - to identify
related work units.  It assumes that these values will be unique, and
that only one WU can be running with the same flow (or frame).  If the
same flow pointer is used for several simultaneous WUs (such as
passing an integer rather than an explicit flow object), then the
analysis can be confused.

# What's part of the same operation.

Describing and drawing WUs requires some way of grouping WUs related
to a single purpose.  This falls into two categories: WUs that are
completely unrelated (such as supporting different services), and WUs
that represent sub-tasks of an existing WU that might deserve to be
broken out separately.

One possibly way of splitting things up is as follows:
* WUs can be broken into transactions.
* Transactions are either started by an incoming request, or by what
appears to be iteration in WUs started from wuh_bootstrap.
* From a WU at the start of the transaction, wu_send indicates a
“next” event.  If a WU triggers more than one send, then there can be
more than one next event.
* Calls can be treated either as next events, or as sub-events.  Sub-events might make more sense.
* Timer triggers, calls, and fork/joins count as sub-events for the event that triggered them.


